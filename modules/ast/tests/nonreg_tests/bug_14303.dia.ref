// =============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2016 - Scilab Enterprises - Pierre-Aime AGNEL
//
//  This file is distributed under the same license as the Scilab package.
// =============================================================================
// <-- CLI SHELL MODE -->
//
// <-- Non-regression test for bug 14303 -->
//
// <-- Bugzilla URL -->
// http://bugzilla.scilab.org/14303
//
// <-- Short Description -->
// Display of matrices with scientific notation and lots of digits
// were wrong
A = [1,0,0,0,0,0,0,0;
0,1,0,0,0,0,0,0;
-1,0,2,0,0,0,0,0;
0,-3,0,4,0,0,0,0;
1,0,-8,0,8,0,0,0;
0,5,0,-20,0,16,0,0;
-1,0,18,0,-48,0,32,0;
0,-7,0,56,0,-112,0,64]
 A  = 
   1.   0.   0.    0.    0.    0.     0.    0. 
   0.   1.   0.    0.    0.    0.     0.    0. 
  -1.   0.   2.    0.    0.    0.     0.    0. 
   0.  -3.   0.    4.    0.    0.     0.    0. 
   1.   0.  -8.    0.    8.    0.     0.    0. 
   0.   5.   0.   -20.   0.    16.    0.    0. 
  -1.   0.   18.   0.   -48.   0.     32.   0. 
   0.  -7.   0.    56.   0.   -112.   0.    64.
//display is ok
disp(nearfloat("succ", expm(A)));
         column 1 to 6
   2.7182818   0.          0.          0.          0.          0.       
   0.          2.7182818   0.          0.0000001   0.         -0.0000002
  -4.6707743   0.          7.3890561   0.          0.          0.       
   0.         -51.879868   0.          54.59815    0.          0.0000002
   986.51887   0.         -3964.7586   0.          2980.9581   0.       
   0.          5923608.3   0.         -14809151.   0.          8885544.9
  -3.505D+12   0.          2.980D+13   0.         -5.258D+13   0.       
   0.         -1.908D+08   0.          8.924D+08   0.         -1.243D+09
         column 7 to 8
   0.          0.       
   0.          8.396D-08
   0.          0.       
   0.         -7.490D-08
  -0.000061    0.       
   0.          0.000001 
   2.629D+13   0.       
   0.          5.417D+08
// now display is ok
format(25);
disp(nearfloat("succ", expm(A)));
         column 1 to 2
   2.7182818284590464230632   0.                      
   0.                         2.7182818015177230286383
  -4.6707742704716030957002   0.                      
   0.                        -51.879868171559827771944
   986.5188713849157693403    0.                      
   0.                         5923608.3361952332779765
  -3505325614554.6103515625   0.                      
   0.                        -190824518.1199035346508 
         column 3 to 4
   0.                         0.                      
   0.                         0.0000001317192458835057
   7.3890560989306477424066   0.                      
   0.                         54.598149892965437857129
  -3964.7586192011622188147   0.                      
   0.                        -14809150.540157750248909
   29795267732595.2109375     0.                      
   0.                         892372855.75740468502045
         column 5 to 6
   0.                         0.                      
   0.                        -0.0000001887344807005063
   0.                         0.                      
   0.                         0.0000001819498482334282
   2980.9580906107221380807   0.                      
   0.                         8885544.9222434218972921
  -52579884242037.6640625     0.                      
   0.                        -1243259289.7225639820099
         column 7 to 8
   0.                         0.                      
   0.                         0.0000000839564363063566
   0.                         0.                      
   0.                        -0.000000074896572352002 
  -0.0000609660211250409175   0.                      
   0.                         0.0000009705089855263860
   26289942123999.796875      0.                      
   0.                         541710954.80334532260895
A =  matrix(linspace(-1E10,1E20,64), 8, 8);
disp(A);
         column 1 to 3
  -10000000000.            12698412689682542592.   25396825389365084160.
   1587301577460317696.    14285714277142859776.   26984126976825401344.
   3174603164920635392.    15873015864603176960.   28571428564285718528.
   4761904752380952576.    17460317452063494144.   30158730151746035712.
   6349206339841270784.    19047619039523811328.   31746031739206352896.
   7936507927301587968.    20634920626984128512.   33333333326666670080.
   9523809514761904128.    22222222214444445696.   34920634914126987264.
   11111111102222221312.   23809523801904762880.   36507936501587304448.
         column 4 to 6
   38095238089047621632.   50793650788730167296.   63492063488412704768.
   39682539676507947008.   52380952376190484480.   65079365075873021952.
   41269841263968256000.   53968253963650801664.   66666666663333339136.
   42857142851428573184.   55555555551111110656.   68253968250793656320.
   44444444438888890368.   57142857138571436032.   69841269838253973504.
   46031746026349215744.   58730158726031753216.   71428571425714298880.
   47619047613809524736.   60317460313492070400.   73015873013174607872.
   49206349201269841920.   61904761900952379392.   74603174600634908672.
         column 7 to 8
   76190476188095234048.   88888888887777771520. 
   77777777775555559424.   90476190475238096896. 
   79365079363015884800.   92063492062698422272. 
   80952380950476177408.   93650793650158731264. 
   82539682537936502784.   95238095237619040256. 
   84126984125396828160.   96825396825079365632. 
   85714285712857137152.   98412698412539674624. 
   87301587300317462528.   100000000000000000000.
format(10);
disp(A);
         column 1 to 6
  -1.000D+10   1.270D+19   2.540D+19   3.810D+19   5.079D+19   6.349D+19
   1.587D+18   1.429D+19   2.698D+19   3.968D+19   5.238D+19   6.508D+19
   3.175D+18   1.587D+19   2.857D+19   4.127D+19   5.397D+19   6.667D+19
   4.762D+18   1.746D+19   3.016D+19   4.286D+19   5.556D+19   6.825D+19
   6.349D+18   1.905D+19   3.175D+19   4.444D+19   5.714D+19   6.984D+19
   7.937D+18   2.063D+19   3.333D+19   4.603D+19   5.873D+19   7.143D+19
   9.524D+18   2.222D+19   3.492D+19   4.762D+19   6.032D+19   7.302D+19
   1.111D+19   2.381D+19   3.651D+19   4.921D+19   6.190D+19   7.460D+19
         column 7 to 8
   7.619D+19   8.889D+19
   7.778D+19   9.048D+19
   7.937D+19   9.206D+19
   8.095D+19   9.365D+19
   8.254D+19   9.524D+19
   8.413D+19   9.683D+19
   8.571D+19   9.841D+19
   8.730D+19   1.000D+20
s = ["-0.034" "- 0.034"  "+1234.5678" "1234 5678"
"1e43"   "-3.5d-12" "-1.2+i"     "i+1.2"
""       "%inf"     "Inf"        "-Inf"
"%i"     "%pi"      "%e"         "%eps"
];
format(10);
disp(strtod(s));
  -0.034       Nan   1234.5678   1234.
   1.000D+43  -3.5  -1.2         Nan  
   Nan         Nan   Nan         Nan  
   Nan         Nan   Nan         Nan  
// display with complex numbers
A =  matrix(linspace(-1E10,1E20,64), 8, 8);
B =  matrix(linspace(1E20,-1E10,64), 8, 8);
B(7, 7) = %nan;
B(2, 1) = %inf;
A(2, 1) = %nan;
A(3, 3) = %nan;
B(4, 4) = 0;
B(4, 3) = -B(4, 3);
A(4, 3) = -A(4, 3);
A(5, 5) = 0;
B(5, 5) = -B(5, 5);
A(6, 6) = 0;
B(6, 6) = 1;
format(25);
disp(A + %i * B);
         column 1
  -10000000000. + 100000000000000000000.i        
   Nan + Infi                                    
   3174603164920635392. + 96825396825079365632.i 
   4761904752380952576. + 95238095237619040256.i 
   6349206339841270784. + 93650793650158731264.i 
   7936507927301587968. + 92063492062698405888.i 
   9523809514761904128. + 90476190475238096896.i 
   11111111102222221312. + 88888888887777771520.i
         column 2
   12698412689682542592. + 87301587300317462528.i
   14285714277142859776. + 85714285712857137152.i
   15873015864603176960. + 84126984125396828160.i
   17460317452063494144. + 82539682537936502784.i
   19047619039523811328. + 80952380950476193792.i
   20634920626984128512. + 79365079363015868416.i
   22222222214444445696. + 77777777775555559424.i
   23809523801904762880. + 76190476188095234048.i
         column 3
   25396825389365084160. + 74603174600634925056.i
   26984126976825401344. + 73015873013174599680.i
   Nan + 71428571425714282496.i                  
  -30158730151746035712. - 69841269838253965312.i
   31746031739206352896. + 68253968250793648128.i
   33333333326666670080. + 66666666663333330944.i
   34920634914126987264. + 65079365075873013760.i
   36507936501587304448. + 63492063488412696576.i
         column 4
   38095238089047621632. + 61904761900952379392.i
   39682539676507947008. + 60317460313492054016.i
   41269841263968256000. + 58730158726031745024.i
   42857142851428573184.                         
   44444444438888890368. + 55555555551111110656.i
   46031746026349215744. + 53968253963650785280.i
   47619047613809524736. + 52380952376190476288.i
   49206349201269841920. + 50793650788730159104.i
         column 5
   50793650788730167296. + 49206349201269833728.i
   52380952376190484480. + 47619047613809516544.i
   53968253963650801664. + 46031746026349199360.i
   55555555551111110656. + 44444444438888890368.i
  -42857142851428564992.i                        
   58730158726031753216. + 41269841263968247808.i
   60317460313492070400. + 39682539676507930624.i
   61904761900952379392. + 38095238089047621632.i
         column 6
   63492063488412704768. + 36507936501587296256.i
   65079365075873021952. + 34920634914126979072.i
   66666666663333339136. + 33333333326666661888.i
   68253968250793656320. + 31746031739206344704.i
   69841269838253973504. + 30158730151746027520.i
   i                                             
   73015873013174607872. + 26984126976825393152.i
   74603174600634908672. + 25396825389365084160.i
         column 7
   76190476188095234048. + 23809523801904758784.i
   77777777775555559424. + 22222222214444433408.i
   79365079363015884800. + 20634920626984108032.i
   80952380950476177408. + 19047619039523815424.i
   82539682537936502784. + 17460317452063490048.i
   84126984125396828160. + 15873015864603164672.i
   Nan + Nani                                    
   87301587300317462528. + 12698412689682530304.i
         column 8
   88888888887777771520. + 11111111102222221312.i
   90476190475238096896. + 9523809514761895936.i 
   92063492062698422272. + 7936507927301570560.i 
   93650793650158731264. + 6349206339841261568.i 
   95238095237619040256. + 4761904752380952576.i 
   96825396825079365632. + 3174603164920627200.i 
   98412698412539674624. + 1587301577460318208.i 
   100000000000000000000. - 10000000000.i        
format(10);
disp(A + %i * B);
         column 1 to 2
  -1.000D+10 + 1.000D+20i   1.270D+19 + 8.730D+19i
   Nan + Infi               1.429D+19 + 8.571D+19i
   3.175D+18 + 9.683D+19i   1.587D+19 + 8.413D+19i
   4.762D+18 + 9.524D+19i   1.746D+19 + 8.254D+19i
   6.349D+18 + 9.365D+19i   1.905D+19 + 8.095D+19i
   7.937D+18 + 9.206D+19i   2.063D+19 + 7.937D+19i
   9.524D+18 + 9.048D+19i   2.222D+19 + 7.778D+19i
   1.111D+19 + 8.889D+19i   2.381D+19 + 7.619D+19i
         column 3 to 4
   2.540D+19 + 7.460D+19i   3.810D+19 + 6.190D+19i
   2.698D+19 + 7.302D+19i   3.968D+19 + 6.032D+19i
   Nan + 7.143D+19i         4.127D+19 + 5.873D+19i
  -3.016D+19 - 6.984D+19i   4.286D+19             
   3.175D+19 + 6.825D+19i   4.444D+19 + 5.556D+19i
   3.333D+19 + 6.667D+19i   4.603D+19 + 5.397D+19i
   3.492D+19 + 6.508D+19i   4.762D+19 + 5.238D+19i
   3.651D+19 + 6.349D+19i   4.921D+19 + 5.079D+19i
         column 5 to 6
   5.079D+19 + 4.921D+19i   6.349D+19 + 3.651D+19i
   5.238D+19 + 4.762D+19i   6.508D+19 + 3.492D+19i
   5.397D+19 + 4.603D+19i   6.667D+19 + 3.333D+19i
   5.556D+19 + 4.444D+19i   6.825D+19 + 3.175D+19i
  -4.286D+19i               6.984D+19 + 3.016D+19i
   5.873D+19 + 4.127D+19i   i                     
   6.032D+19 + 3.968D+19i   7.302D+19 + 2.698D+19i
   6.190D+19 + 3.810D+19i   7.460D+19 + 2.540D+19i
         column 7 to 8
   7.619D+19 + 2.381D+19i   8.889D+19 + 1.111D+19i
   7.778D+19 + 2.222D+19i   9.048D+19 + 9.524D+18i
   7.937D+19 + 2.063D+19i   9.206D+19 + 7.937D+18i
   8.095D+19 + 1.905D+19i   9.365D+19 + 6.349D+18i
   8.254D+19 + 1.746D+19i   9.524D+19 + 4.762D+18i
   8.413D+19 + 1.587D+19i   9.683D+19 + 3.175D+18i
   Nan + Nani               9.841D+19 + 1.587D+18i
   8.730D+19 + 1.270D+19i   1.000D+20 - 1.000D+10i
format("e");
disp(A + %i * B);
         column 1 to 2
  -1.000D+10 + 1.000D+20i   1.270D+19 + 8.730D+19i
   Nan + Infi               1.429D+19 + 8.571D+19i
   3.175D+18 + 9.683D+19i   1.587D+19 + 8.413D+19i
   4.762D+18 + 9.524D+19i   1.746D+19 + 8.254D+19i
   6.349D+18 + 9.365D+19i   1.905D+19 + 8.095D+19i
   7.937D+18 + 9.206D+19i   2.063D+19 + 7.937D+19i
   9.524D+18 + 9.048D+19i   2.222D+19 + 7.778D+19i
   1.111D+19 + 8.889D+19i   2.381D+19 + 7.619D+19i
         column 3 to 4
   2.540D+19 + 7.460D+19i   3.810D+19 + 6.190D+19i
   2.698D+19 + 7.302D+19i   3.968D+19 + 6.032D+19i
   Nan + 7.143D+19i         4.127D+19 + 5.873D+19i
  -3.016D+19 - 6.984D+19i   4.286D+19             
   3.175D+19 + 6.825D+19i   4.444D+19 + 5.556D+19i
   3.333D+19 + 6.667D+19i   4.603D+19 + 5.397D+19i
   3.492D+19 + 6.508D+19i   4.762D+19 + 5.238D+19i
   3.651D+19 + 6.349D+19i   4.921D+19 + 5.079D+19i
         column 5 to 6
   5.079D+19 + 4.921D+19i   6.349D+19 + 3.651D+19i
   5.238D+19 + 4.762D+19i   6.508D+19 + 3.492D+19i
   5.397D+19 + 4.603D+19i   6.667D+19 + 3.333D+19i
   5.556D+19 + 4.444D+19i   6.825D+19 + 3.175D+19i
  -4.286D+19i               6.984D+19 + 3.016D+19i
   5.873D+19 + 4.127D+19i   1.000D+00i            
   6.032D+19 + 3.968D+19i   7.302D+19 + 2.698D+19i
   6.190D+19 + 3.810D+19i   7.460D+19 + 2.540D+19i
         column 7 to 8
   7.619D+19 + 2.381D+19i   8.889D+19 + 1.111D+19i
   7.778D+19 + 2.222D+19i   9.048D+19 + 9.524D+18i
   7.937D+19 + 2.063D+19i   9.206D+19 + 7.937D+18i
   8.095D+19 + 1.905D+19i   9.365D+19 + 6.349D+18i
   8.254D+19 + 1.746D+19i   9.524D+19 + 4.762D+18i
   8.413D+19 + 1.587D+19i   9.683D+19 + 3.175D+18i
   Nan + Nani               9.841D+19 + 1.587D+18i
   8.730D+19 + 1.270D+19i   1.000D+20 - 1.000D+10i
